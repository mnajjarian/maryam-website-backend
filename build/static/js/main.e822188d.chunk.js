(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[27],{100:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(28),c=a.n(r),s=a(8),l=a(9),i=a(11),u=a(42),d=a(7),m=a(21),p=a.n(m),f=a(29),h=a(16),b=a(1),g=a(12),E=a(25),y=a(14),v={username:"",password:""};function _(){var e=Object(n.useState)(v),t=Object(g.a)(e,2),a=t[0],r=t[1],c=Object(n.useContext)(l.a),s=c.authDispatch,i=c.authState.isLoggedIn,u=new y.a(s),m=a.username,_=a.password,O=function(e){var t=e.target,n=t.name,o=t.value;r(Object(b.a)({},a,Object(h.a)({},n,o)))},P=function(){var e=Object(f.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,u.signin(a);case 4:return e.abrupt("return",o.a.createElement(d.a,{to:"/dashboard"}));case 7:e.prev=7,e.t0=e.catch(1),alert(e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}();return i?o.a.createElement(d.a,{to:"/dashboard"}):o.a.createElement("div",{className:"login"},o.a.createElement("h1",null,"Please login to continue"),o.a.createElement("form",{className:"form",onSubmit:P},o.a.createElement("div",{className:"form__group"},o.a.createElement("label",{className:"form__label",htmlFor:"username"},"Username"),o.a.createElement("input",{className:"form__input",type:"text",name:"username",placeholder:"Username",value:m,onChange:O})),o.a.createElement("div",{className:"form__group"},o.a.createElement("label",{className:"form__label",htmlFor:"password"},"Password"),o.a.createElement("input",{className:"form__input",type:"password",name:"password",placeholder:"Password",value:_,onChange:O})),o.a.createElement("div",{className:"form__button"},o.a.createElement(E.a,{text:"Login"}))))}var O=a(18),P=function(e){return Object(n.lazy)((function(){return a(98)("./".concat(e,"/").concat(e)).then((function(t){return{default:t[e]}}))}))},S=P("Home"),C=P("Blog"),w=P("Post");function j(){var e=Object(n.useContext)(l.a).authState.isLoggedIn;return o.a.createElement(d.d,null,o.a.createElement(d.b,{exact:!0,path:"/",component:S}),o.a.createElement(d.b,{exact:!0,path:"/login",component:_}),o.a.createElement(d.b,{exact:!0,path:"/blog",component:C}),o.a.createElement(d.b,{exact:!0,path:"/blog/:postId",component:w}),o.a.createElement((function(t){var a=t.Component,n=t.path,r=Object(u.a)(t,["Component","path"]);return o.a.createElement(d.b,{path:n,render:function(t){return e?o.a.createElement(a,Object.assign({},t,r)):o.a.createElement(d.a,{to:{pathname:"/login",state:{from:t.location}}})}})}),{path:"/dashboard",Component:O.Dashboard}))}var x=a(26);a(99);var N=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function R(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}c.a.render(o.a.createElement(l.b,null,o.a.createElement(i.b,null,o.a.createElement(s.a,null,o.a.createElement((function(){var e=Object(n.useContext)(l.a).authDispatch,t=Object(n.useContext)(i.a).dataDispatch;return Object(n.useEffect)((function(){var a=new x.a(t);new y.a(e).authenticate(),a.getUsers(),a.getPosts(),a.getGallery()}),[t,e]),o.a.createElement(n.Suspense,{fallback:o.a.createElement("div",null)},o.a.createElement(j,null))}),null)))),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");N?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):R(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):R(t,e)}))}}()},11:function(e,t,a){"use strict";var n=a(12),o=a(0),r=a.n(o),c=a(1),s={isFetched:!1,blogs:[],users:[],gallery:[],message:null};var l=function(e,t){switch(t.type){case"FETCH_USERS":return Object(c.a)({},e,{users:t.payload});case"UPDATE_USER":return Object(c.a)({},e,{users:e.users.map((function(e){return e._id!==t.payload.userId?e:t.payload}))});case"UPDATE_USER_IMAGE":var a=e.users.filter((function(e){return e._id===t.payload.userId}))[0];return a.imageUrl=t.payload.obj.imageUrl,Object(c.a)({},e,{users:e.users.map((function(e){return e._id!==t.payload.userId?e:a}))});case"FETCH_POSTS":return Object(c.a)({},e,{blogs:(r=t.payload,r.sort((function(e,t){return Number(new Date(t.createdAt))-Number(new Date(e.createdAt))})))});case"POSTS_FECHED":return Object(c.a)({},e,{isFetched:!0});case"FETCH_GALLERY":return Object(c.a)({},e,{gallery:t.payload});case"SET_AVATAR":return Object(c.a)({},e);case"ADD_GALLERY":return Object(c.a)({},e,{gallery:e.gallery.concat(t.payload)});case"ADD_POST":return Object(c.a)({},e,{blogs:e.blogs.concat(t.payload)});case"EDIT_POST":return Object(c.a)({},e,{blogs:e.blogs.map((function(e){return e.id!==t.payload.id?e:t.payload}))});case"REMOVE_POST":return Object(c.a)({},e,{blogs:e.blogs.filter((function(e){return e.id!==t.payload}))});case"REMOVE_IMAGE":return Object(c.a)({},e,{gallery:e.gallery.filter((function(e){return e.public_id!==t.payload}))});case"ADD_COMMENT":var n=e.blogs.filter((function(e){return e.id===t.payload.post}))[0];return n.comments=n.comments.concat(t.payload),Object(c.a)({},e,{blogs:e.blogs.map((function(e){return e.id===t.payload._id?n:e}))});case"REMOVE_COMMENT":var o=e.blogs.filter((function(e){return e.id===t.payload.post}))[0];return o.comments=o.comments.filter((function(e){return e._id!==t.payload._id})),Object(c.a)({},e,{blogs:e.blogs.map((function(e){return e.id===t.payload.post?o:e}))});case"ERROR_MESSAGE":return Object(c.a)({},e,{message:t.payload});case"REMOVE_MESSAGE":return Object(c.a)({},e,{message:null});default:return function(e){throw new Error("Unexpected object: "+e)}(t)}var r};a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return u}));var i=Object(o.createContext)({}),u=function(e){var t=e.children,a=Object(o.useReducer)(l,s),c=Object(n.a)(a,2),u={data:c[0],dataDispatch:c[1]};return r.a.createElement(i.Provider,{value:u},t)}},14:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(19),o=a(3),r=function e(t){var a=this;Object(n.a)(this,e),this.dispatch=void 0,this.signup=function(e){o.a.post("/signup",e).then((function(e){a.dispatch({type:"SIGNIN_SUCCESS",payload:e.data})})).catch((function(e){a.dispatch({type:"SET_ERRORS",payload:e.message})}))},this.signin=function(e){o.a.post("/login",e).then((function(e){a.dispatch({type:"SIGNIN_SUCCESS",payload:e.data})})).catch((function(e){a.dispatch({type:"SET_ERRORS",payload:e.message})}))},this.logout=function(){o.a.get("/logout").then((function(){a.dispatch({type:"LOGOUT_USER"})})).catch((function(e){console.log(e)}))},this.authenticate=function(){o.a.get("/auth").then((function(e){a.dispatch({type:"SET_AUTH",payload:e.data})})).catch((function(e){console.log(e)}))},this.dispatch=t}},17:function(e,t,a){"use strict";a.r(t);var n=a(12),o=a(0),r=a.n(o),c=a(20),s=a.n(c),l=a(7),i=a(8),u=a(9),d=a(11),m=a(14);function p(){var e=Object(o.useState)(!1),t=Object(n.a)(e,2),c=t[0],p=t[1],f=Object(o.useContext)(u.a).authDispatch,h=new m.a(f),b=Object(o.useContext)(d.a).data.users,g=Object(l.g)(),E=b[0],y=E?E.imageUrl:a(63),v=function(){h.logout(),g.push("/")},_=Object(o.useRef)(null);!function(e,t){Object(o.useEffect)((function(){var a=function(a){e.current&&!e.current.contains(a.target)&&t()};return document.addEventListener("mousedown",a),function(){document.removeEventListener("mousedown",a)}}),[e,t])}(_,(function(){return p(!1)}));var O=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"nav__list__group"},r.a.createElement(i.b,{to:"/"},"Home")),r.a.createElement("div",{className:"nav__list__group"},r.a.createElement(i.b,{to:"/dashboard/profile"},"Profile")),r.a.createElement("div",{className:"nav__list__group"},r.a.createElement(i.b,{to:"/dashboard/gallery"},"Gallery")),r.a.createElement("div",{className:"nav__list__group"},r.a.createElement(i.b,{to:"/dashboard/posts"},"Posts")),r.a.createElement("div",{className:"nav__list__group"},r.a.createElement(i.b,{to:"/dashboard/create"},"Create new")),r.a.createElement("div",{className:"nav__list__logout"},r.a.createElement("li",{onClick:v},"Logout")))};return r.a.createElement("div",{className:"nav"},r.a.createElement("ul",{className:"nav__list"},O()),r.a.createElement("div",{ref:_,className:"nav__icon",onClick:function(){return p(!c)}},r.a.createElement("img",{className:"nav__icon__image",src:y,alt:"admin"}),r.a.createElement("ul",{className:s()({nav__logout:!0,"nav__logout-hide":!c})},r.a.createElement("li",{onClick:v},"Logout")),r.a.createElement("ul",{className:s()({nav__menu:!0,"nav__menu-hide":!c})},O())))}a.d(t,"Nav",(function(){return p}))},18:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(17),c=a(7),s=a(11);function l(){var e=Object(n.useContext)(s.a).data.message;return e?o.a.createElement("div",{style:{position:"absolute",top:"2em",left:0,right:0,padding:"1em",background:"red"}},o.a.createElement("h1",null,e)):o.a.createElement("div",null)}a.d(t,"Dashboard",(function(){return f})),a.d(t,"DashboardWrapper",(function(){return h}));var i=function(e){return Object(n.lazy)((function(){return a(97)("./".concat(e,"/").concat(e)).then((function(t){return{default:t[e]}}))}))},u=i("Gallery"),d=i("Profile"),m=i("RichEditor"),p=i("PostTable");function f(e){var t=e.match.url;return o.a.createElement(h,null,o.a.createElement(c.b,{path:"".concat(t,"/profile"),component:d,exact:!0}),o.a.createElement(c.b,{path:"".concat(t,"/gallery"),component:u,exact:!0}),o.a.createElement(c.b,{path:"".concat(t,"/create"),component:m,exact:!0}),o.a.createElement(c.b,{path:"".concat(t,"/edit/:postId"),component:m,exact:!0}),o.a.createElement(c.b,{path:"".concat(t,"/posts"),component:p,exact:!0}))}function h(e){var t=e.children;return o.a.createElement("div",{className:"dashboard"},o.a.createElement(r.Nav,null),o.a.createElement(l,null),o.a.createElement("div",{className:"dashboard__content"},t))}},25:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(0),o=a.n(n);function r(e){var t=e.text,a=e.handleClick;return o.a.createElement("button",{type:"submit",className:"button",onClick:a},t)}},26:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(19),o=a(3),r=function e(t){var a=this;Object(n.a)(this,e),this.dispatch=void 0,this.getPosts=function(){o.a.get("/posts").then((function(e){a.dispatch({type:"FETCH_POSTS",payload:e.data})})).catch((function(e){console.log("getPosts: ",e)}))},this.createNewPost=function(e){o.a.post("/posts",e).then((function(e){a.dispatch({type:"ADD_POST",payload:e.data})})).catch((function(e){console.log("createNewPost: ",e)}))},this.updatePost=function(e,t){o.a.put("/posts/".concat(e),{content:t}).then((function(e){a.dispatch({type:"EDIT_POST",payload:e.data})})).catch((function(e){console.log(e)}))},this.getUsers=function(){o.a.get("/users").then((function(e){a.dispatch({type:"FETCH_USERS",payload:e.data})})).catch((function(e){console.log("getUsers: ",e)}))},this.updateUser=function(e,t,n){o.a.put("/users/".concat(e),{obj:t,publicId:n}).then((function(e){e.data._id?a.dispatch({type:"UPDATE_USER",payload:e.data}):a.dispatch({type:"ERROR_MESSAGE",payload:e.data})})).catch((function(e){console.log("updateUser: ",e)}))},this.removeImage=function(e){o.a.delete("/assets/".concat(e)).then((function(){a.dispatch({type:"REMOVE_IMAGE",payload:e})})).catch((function(e){console.log("removeImage: ",e)}))},this.removeAssets=function(e){o.a.post("/assets",e).then((function(e){console.log(e.data)}))},this.removePost=function(e){o.a.delete("/posts/".concat(e)).then((function(){a.dispatch({type:"REMOVE_POST",payload:e})})).catch((function(e){console.log("removePost: ",e)}))},this.addComment=function(e){o.a.post("/comments",e).then((function(e){a.dispatch({type:"ADD_COMMENT",payload:e.data})})).catch((function(e){console.log("addComment: ",e)}))},this.removeComment=function(e){o.a.delete("/comments/".concat(e)).then((function(e){a.dispatch({type:"REMOVE_COMMENT",payload:e.data})})).catch((function(){window.location.href="/dashboard/posts"}))},this.getGallery=function(){o.a.get("/gallery").then((function(e){var t=e.data.filter((function(e){return"json"!==e.format}));a.dispatch({type:"FETCH_GALLERY",payload:t})})).catch((function(e){console.log("getGallery: ",e)}))},this.dispatch=t}},3:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(39),o=a.n(n).a.create({withCredentials:!0,baseURL:"/api"})},63:function(e,t,a){e.exports=a.p+"static/media/avatar.41c9a2b3.png"},71:function(e,t,a){e.exports=a(100)},9:function(e,t,a){"use strict";var n=a(12),o=a(0),r=a.n(o),c=a(1),s={isLoggedIn:!1},l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SIGNIN_ERROR":case"SIGNUP_ERROR":return Object(c.a)({},e,{error:t.payload});case"SIGNIN_SUCCESS":return Object(c.a)({},e,{id:t.payload.id,isLoggedIn:!0,error:null});case"LOGOUT_USER":return Object(c.a)({},e,{isLoggedIn:!1,error:null});case"SET_AUTH":return Object(c.a)({},e,{isLoggedIn:t.payload.auth});default:return e}};a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return u}));var i=Object(o.createContext)({}),u=function(e){var t=e.children,a=Object(o.useReducer)(l,s),c=Object(n.a)(a,2),u={authState:c[0],authDispatch:c[1]};return r.a.createElement(i.Provider,{value:u},t)}},97:function(e,t,a){var n={"./CommentList/CommentList":[53,9,15],"./CommentList/CommentList.tsx":[53,9,15],"./CommentList/_style.scss":[101,7,43],"./Dashboard":[18,9],"./Dashboard.tsx":[18,9],"./Gallery/Gallery":[48,9,16],"./Gallery/Gallery.tsx":[48,9,16],"./Gallery/_style.scss":[102,7,44],"./HeaderStyleDropdown/HeaderStyleDropdown":[45,9,18],"./HeaderStyleDropdown/HeaderStyleDropdown.tsx":[45,9,18],"./Media/Media":[49,9,19],"./Media/Media.tsx":[49,9,19],"./MediaBlockRenderer/MediaBlockRenderer":[54,9,17],"./MediaBlockRenderer/MediaBlockRenderer.tsx":[54,9,17],"./Nav/Nav":[17,9],"./Nav/Nav.tsx":[17,9],"./Nav/_style.scss":[103,7,30],"./PctureChoice/PctureChoice":[44,9,20],"./PctureChoice/PctureChoice.tsx":[44,9,20],"./PctureChoice/_style.scss":[104,7,45],"./PostTable/PostTable":[64,9,9],"./PostTable/PostTable.tsx":[64,9,9],"./PostTable/_style.scss":[105,7,31],"./Preview/Preview":[65,9,0,1,11],"./Preview/Preview.tsx":[65,9,0,1,11],"./Profile/Profile":[66,9,21],"./Profile/Profile.tsx":[66,9,21],"./Profile/_style.scss":[106,7,32],"./RichEditor/RichEditor":[67,9,0,2],"./RichEditor/RichEditor.tsx":[67,9,0,2],"./RichEditor/_style.scss":[107,7,46],"./StyleButton/StyleButton":[46,9,5],"./StyleButton/StyleButton.tsx":[46,9,5],"./StyleTypes/StyleTypes":[50,9,4],"./StyleTypes/StyleTypes.tsx":[50,9,4],"./Toolbar/Toolbar":[56,9,0,3],"./Toolbar/Toolbar.tsx":[56,9,0,3],"./Toolbar/_style.scss":[108,7,33],"./_main.scss":[109,7,34],"./draft.db":[55,3,26],"./draft.db.json":[55,3,26]};function o(e){if(!a.o(n,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],o=t[0];return Promise.all(t.slice(2).map(a.e)).then((function(){return a.t(o,t[1])}))}o.keys=function(){return Object.keys(n)},o.id=97,e.exports=o},98:function(e,t,a){var n={"./Blog/Blog":[68,9,7],"./Blog/Blog.tsx":[68,9,7],"./Blog/BlogBody/BlogBody":[57,9,10],"./Blog/BlogBody/BlogBody.tsx":[57,9,10],"./Blog/BlogBody/_style.scss":[110,7,47],"./Blog/CardPost/CardPost":[51,9,12],"./Blog/CardPost/CardPost.tsx":[51,9,12],"./Blog/CardPost/_style.scss":[111,7,35],"./Blog/Jumbotron/Jumbotrun":[58,9,22],"./Blog/Jumbotron/Jumbotrun.tsx":[58,9,22],"./Blog/Jumbotron/_style.scss":[112,7,36],"./Blog/_style.scss":[113,7,37],"./Home/About/About":[59,9,23],"./Home/About/About.tsx":[59,9,23],"./Home/About/_style.scss":[114,7,48],"./Home/Header/Header":[60,9,24],"./Home/Header/Header.tsx":[60,9,24],"./Home/Header/_style.scss":[115,7,38],"./Home/Home":[69,9,8],"./Home/Home.tsx":[69,9,8],"./Home/LatestPost/LatestPost":[61,9,14],"./Home/LatestPost/LatestPost.tsx":[61,9,14],"./Home/LatestPost/_style.scss":[116,7,39],"./Home/_style.scss":[117,7,40],"./Post/AddComment/AddComment":[52,9,25],"./Post/AddComment/AddComment.tsx":[52,9,25],"./Post/Comment/Comment":[62,9,13],"./Post/Comment/Comment.tsx":[62,9,13],"./Post/Comment/_style.scss":[118,7,49],"./Post/Post":[70,9,0,1,6],"./Post/Post.tsx":[70,9,0,1,6],"./Post/_style.scss":[119,7,41],"./_style.scss":[120,7,42]};function o(e){if(!a.o(n,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],o=t[0];return Promise.all(t.slice(2).map(a.e)).then((function(){return a.t(o,t[1])}))}o.keys=function(){return Object.keys(n)},o.id=98,e.exports=o},99:function(e,t,a){}},[[71,28,29]]]);
//# sourceMappingURL=main.e822188d.chunk.js.map